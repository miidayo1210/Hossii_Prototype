# Hossii プロトタイプ 仕様概要

> 最終更新: 2026-02-23

---

## 概要

Hossii は「感情・つぶやきをリアルタイムで空間に流す」アプリ。
スペース単位で投稿を管理し、キャラクター（Hossii）が反応する仕組みを持つ。

---

## 機能一覧

### 1. 投稿（Hossii 投稿）

| 項目 | 内容 |
|------|------|
| 入力内容 | メッセージ（任意・200文字以内）＋ 感情選択（任意） |
| 送信条件 | メッセージ または 感情のどちらか一方があれば送信可 |
| 投稿種別 | 手動（manual）/ 自動（auto） |
| 送信者名 | スペース固有ニックネーム → デフォルトニックネーム の順で使用 |
| 写真添付 | UI のみ実装（機能未実装） |

---

### 2. スペース

| 項目 | 内容 |
|------|------|
| 作成 | 名前・カードタイプを指定して作成 |
| 切替 | 画面内で任意に切替可能 |
| 削除 | スペース一覧画面から削除可 |
| 共有 | `?space=<id>` 形式の招待リンクを生成・共有 |
| 参加 | 招待リンク経由でスペースに参加（ID 直接入力も可） |
| 背景設定 | カラー / パターン（5種）/ 画像 の3種類 |
| 複数スペース | 複数スペースを保持・切替可能 |

**背景パターン:** mist / dots / grid / waves / stars

---

### 3. スペース表示（スペースビュー）

| 項目 | 内容 |
|------|------|
| 表示形式 | バブル（PC）/ スター（SP）で投稿を表示 |
| 表示上限 | 最新40件 |
| フィルター | 手動投稿 / 感情ログ / 音声ログ / 笑いログ で絞込み |
| 投稿位置 | index に基づく deterministic な配置 |
| 多タブ同期 | BroadcastChannel で他タブの投稿をリアルタイム反映 |

---

### 4. キャラクター（HossiiLive）

| 項目 | 内容 |
|------|------|
| 動作 | Viewport 全体をランダムに移動（4.5〜8秒で移動、1〜2.5秒休憩） |
| 投稿反応 | 新規投稿時に表情変化・吹き出し・パーティクル表示 |
| タップ反応 | タップでランダムセリフ表示（5秒間）、逃げる/寄るアクション |
| カラー | pink / blue / yellow / green / purple（5種） |
| 表示切替 | 設定からオン/オフ可能 |

**表示優先順位:** interaction > reaction > listening > idle

---

### 5. Listen モード（自動投稿）

| 項目 | 内容 |
|------|------|
| 有効化 | 設定画面またはスペースビューのトグルから有効化 |
| 初回同意 | 有効化時にマイク使用の同意確認 |
| 音声ログ | 発話内容をテキスト化して自動投稿（Web Speech API） |
| 感情ログ | 音響分析による感情の自動投稿 |

**感情の自動検出:**

| 検出パターン | 感情 |
|-------------|------|
| 笑い声（断続的な中音量） | laugh |
| 大きな音（RMS > 0.5） | wow |
| 長い無音（8秒以上） | think |

**音声ログの粒度:**

| レベル | 条件 |
|--------|------|
| word | 短い発話 |
| short | 中程度の発話 |
| long | 長い発話 |

---

### 6. ルーティング（画面一覧）

| Screen | URL ハッシュ | 説明 |
|--------|-------------|------|
| post | `#post` | 投稿入力画面 |
| screen | `#screen` | スペースビュー（スペース表示） |
| comments | `#comments` | ログ一覧 |
| spaces | `#spaces` | スペース管理 |
| profile | `#profile` | プロフィール設定 |
| mylogs | `#mylogs` | マイログ |
| account | `#account` | アカウント情報 |
| settings | `#settings` | スペース設定 |
| card | `#card` | スタンプカード |

---

### 7. プロフィール・ニックネーム

| 項目 | 内容 |
|------|------|
| デフォルトニックネーム | 全スペース共通のデフォルト名 |
| スペース固有ニックネーム | スペースごとに個別設定可能 |
| 優先順位 | スペース固有 → デフォルト |

---

### 8. スタンプカード

| 項目 | 内容 |
|------|------|
| 獲得条件 | 手動投稿1件につきスタンプ1個 |
| カード完成 | 20スタンプでカード1枚完成 |
| カードテーマ | grid / spiral / wave / starry / circle（5種） |
| 表示 | 現在のスタンプ数・完成カード数を表示 |

---

### 9. マイログ

| 項目 | 内容 |
|------|------|
| 表示対象 | 自分（authorId が一致）の投稿のみ |
| フィルター | 全スペース / 現在のスペース で切替 |
| 時刻表示 | 相対時間（"5分前" 等） |

---

### 10. 認証（現状：モック実装）

| 項目 | 内容 |
|------|------|
| 方式 | モック認証（localStorage にユーザーデータを保存） |
| 対応メソッド | メールアドレス・Google・Facebook |
| 将来 | Firebase 認証に置き換え予定 |

---

### 11. データ永続化

| データ | 保存先 |
|--------|--------|
| 投稿一覧 | localStorage |
| スペース一覧 | localStorage |
| プロフィール | localStorage |
| スタンプデータ | localStorage |
| Listen 設定 | localStorage |
| 表示スケール | localStorage |
| フィルター状態 | localStorage |

---

### 12. 表示設定

| 項目 | 内容 |
|------|------|
| 表示スケール | 1.0 / 1.25 / 1.5 倍から選択 |
| Hossii 表示 | オン/オフ切替 |

---

### 13. アプリモード

| モード | 説明 |
|--------|------|
| personal | 個人利用モード |
| org | 組織・企業利用モード（詳細未実装） |

---

## 未実装（UI のみ）

- 画像アップロード（投稿への写真添付）
- Firebase / Supabase によるリアルタイム同期
- 組織モード（org）の詳細機能

---

## 技術スタック

| 項目 | 技術 |
|------|------|
| フレームワーク | React + TypeScript |
| ビルド | Vite |
| 状態管理 | Context + useReducer（Zustand 移行を想定） |
| ルーティング | Hash-based（独自実装） |
| 音声認識 | Web Speech API |
| 音響分析 | Web Audio API |
| データ同期 | BroadcastChannel API |
| 永続化 | localStorage |
| 認証 | モック（Firebase 移行予定） |
